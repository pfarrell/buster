<html>
  <head>
  </head>
  <body>
    <div id="tweet" />
    <script>
      function update(json) {
        document.getElementById("tweet").innerHTML = JSON.parse(json.message).text;
      }

      var stream = new EventSource('/tweet_stream');
      stream.addEventListener('message', function(event) {
        update(JSON.parse(event.data));
      }, false);
      

      stream.addEventListener('message', function(e) {
          console.log(e.data);
      }, false);

      stream.addEventListener('open', function(e) {
          console.log(e);
          // Connection was opened.
      }, false);

      stream.addEventListener('error', function(e) {
          console.log(e);
          if (e.readyState == EventSource.CLOSED) {
                // Connection was closed.
                  }
      }, false);
    </script>
  </body>
</html>
